import{j as e}from"./jsx-runtime-Ds-gkUgj.js";import{r as m}from"./index-CtvPRVHf.js";import{a as S,b as D}from"./NewUserInfo-DIrpYPvr.js";import{u as _,a as $}from"./chunk-AYJ5UCUI-CkRdRQ96.js";const h=()=>{var w,N,b;const x=_(),u=$(),o=((w=u.state)==null?void 0:w.isModifying)||!1,i=((N=u.state)==null?void 0:N.userData)||null,A=(b=u.state)==null?void 0:b.userIndex,[s,p]=m.useState({username:"",contact:"",email:"",role:"",password:"",confirmPassword:"",firstName:"",lastName:""}),[t,f]=m.useState({}),[j,g]=m.useState(!1);m.useEffect(()=>{var n,a;if(o&&i){const r=i.name.split(" "),l=r[0]||"",C=r.slice(1).join(" ")||"",E=((n=i.contact)==null?void 0:n.replace("+63",""))||"";p({username:i.username||"",contact:E,email:i.email||"",role:((a=i.roles)==null?void 0:a[0])||"",password:"",confirmPassword:"",firstName:l,lastName:C})}},[o,i]);const d=n=>{const{name:a,value:r}=n.target;p(l=>({...l,[a]:r})),f(l=>({...l,[a]:""}))},U=n=>{n.preventDefault(),g(!0);try{let a={};if(Object.entries(s).forEach(([r,l])=>{o&&(r==="password"||r==="confirmPassword")||(!l||typeof l=="string"&&l.trim()==="")&&(a[r]="This field is required")}),(!o||s.password||s.confirmPassword)&&s.password!==s.confirmPassword&&(a.confirmPassword="Passwords do not match"),s.contact&&!/^\d{10}$/.test(s.contact)&&(a.contact="Contact number must be exactly 10 digits after +63"),s.email&&!s.email.includes("@")&&(a.email="Please enter a valid email address"),f(a),Object.keys(a).length===0){let r;o?(r=S(A,{name:`${s.firstName} ${s.lastName}`,status:i.status,roles:[s.role],image:i.image||"",username:s.username,email:s.email,contact:`+63${s.contact}`,...s.password?{password:s.password}:{}}),alert(r?"User updated successfully!":"Failed to update user. Please try again.")):(r=D(s),alert(r?"User added successfully!":"Failed to add user. Please try again.")),r&&x("/admin-user-management")}}catch(a){console.error("Error submitting form:",a),alert("An error occurred. Please try again.")}finally{g(!1)}};return e.jsxs("div",{children:[e.jsx("h1",{children:o?"Modify User":"Add User"}),e.jsx("div",{className:"admin-add-user",children:e.jsxs("form",{className:"user-form",onSubmit:U,noValidate:!0,children:[e.jsxs("div",{className:"form-grid",children:[[{label:"Username",name:"username"},{label:"Email",name:"email",type:"email"},...o?[]:[{label:"Password",name:"password",type:"password"},{label:"Confirm Password",name:"confirmPassword",type:"password"}],{label:"First Name",name:"firstName"},{label:"Last Name",name:"lastName"}].map(({label:n,name:a,type:r="text"})=>e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:[n," ",e.jsx("span",{className:"required",children:"*"})]}),e.jsx("input",{type:r,name:a,placeholder:`Enter ${n}`,value:s[a],onChange:d,className:t[a]?"error-input":""}),t[a]&&e.jsx("p",{className:"error",children:t[a]})]},a)),o&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Password (leave blank to keep current)"}),e.jsx("input",{type:"password",name:"password",placeholder:"Enter new password",value:s.password,onChange:d,className:t.password?"error-input":""}),t.password&&e.jsx("p",{className:"error",children:t.password})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Confirm Password"}),e.jsx("input",{type:"password",name:"confirmPassword",placeholder:"Confirm new password",value:s.confirmPassword,onChange:d,className:t.confirmPassword?"error-input":""}),t.confirmPassword&&e.jsx("p",{className:"error",children:t.confirmPassword})]})]}),e.jsxs("div",{className:"form-group contact-split",children:[e.jsxs("label",{children:["Contact Number ",e.jsx("span",{className:"required",children:"*"})]}),e.jsxs("div",{className:"contact-input-wrapper",children:[e.jsx("input",{type:"text",value:"+63",disabled:!0,className:"country-code"}),e.jsx("input",{type:"text",name:"contact",placeholder:"Enter 10-digit number",value:s.contact,maxLength:"10",onChange:n=>{const a=n.target.value.replace(/\D/g,"").slice(0,10);p(r=>({...r,contact:a})),f(r=>({...r,contact:""}))},className:`phone-number ${t.contact?"error-input":""}`})]}),t.contact&&e.jsx("p",{className:"error",children:t.contact})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["User Role ",e.jsx("span",{className:"required",children:"*"})]}),e.jsxs("select",{name:"role",value:s.role,onChange:d,className:t.role?"error-input":"",children:[e.jsx("option",{value:"",children:"Select Role"}),e.jsx("option",{value:"Admin",children:"Admin"}),e.jsx("option",{value:"Manager",children:"Manager"}),e.jsx("option",{value:"Staff",children:"Staff"})]}),t.role&&e.jsx("p",{className:"error",children:t.role})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"submit",className:"submit-btn",disabled:j,children:j?o?"Updating User...":"Adding User...":o?"Update User":"Add User"}),e.jsx("button",{type:"button",className:"cancel-btn",onClick:()=>x("/admin-user-management"),children:"Cancel"})]})]})})]})};h.__docgenInfo={description:"",methods:[],displayName:"AdminAddUser"};const O={title:"Components/AdminAddAccount",component:h},c=()=>e.jsx(h,{});c.__docgenInfo={description:"",methods:[],displayName:"Default"};var v,y,P;c.parameters={...c.parameters,docs:{...(v=c.parameters)==null?void 0:v.docs,source:{originalSource:"() => <AdminAddAccount />",...(P=(y=c.parameters)==null?void 0:y.docs)==null?void 0:P.source}}};const L=["Default"];export{c as Default,L as __namedExportsOrder,O as default};
